@page "/V2"
@using Microsoft.FSharp.Core
@rendermode InteractiveServer

<PageTitle>Lambda-Calculus Interpreter v1</PageTitle>
<Header></Header>

<h1>Insert code</h1>

<textarea class="form-control"
          rows="25"
          @bind="userCode">
</textarea>

<button class="btn btn-primary mt-2" @onclick="compile">Compile</button>

<p role="status">Result: @result</p>

@code {
    private string result = "";
    private string userCode = """
    % NB! This is a comment

    % Define some constants
    ten = 10;
    twenty = 20;
    fifty = 50;
    hundred = 100;

    % Some arithmetic
    doubleTen = mul ten (succ ten); % 10 * 11 = 110
    quadrupleTen = mul doubleTen (succ ten); % 110 * 11 = 1210 (will reduce later)
    halfHundred = sub hundred fifty; % 100 - 50 = 50

    % Nested arithmetic using constants
    result1 = add doubleTen halfHundred; % 110 + 50 = 160
    result2 = sub (mul ten twenty) (add fifty ten); % 200 - 60 = 140

    % Recursion
    addRec = λ n m. cond (iszero n) m (addRec (sub n 1) (add m 1));

    print (add 2 2);

    main = fact( add result2 (add (add result1 result2) (addRec (succ ten) (3)) ) ); % (140 + (160 + 140) + (11 + 3))! =~ 7.2670e1101
    print main;
    """;

    private void compile()
    {
        result = execsFastNormal(userCode);
    }
}
